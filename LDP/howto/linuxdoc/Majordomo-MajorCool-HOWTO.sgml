<!doctype linuxdoc system>

<article>
<title>Majordomo and MajorCool HOWTO
<author>John Archie, <tt/johnarchie@emeraldis.com/
<date>v1.0, 10 November 1999
<abstract>
This document is intended to guide a user through an installation of the Majordomo Mailing List Software and MajorCool.  MajorCool is a utility for managing Majordomo lists via a CGI script; many people who are unfamiliar with Majordomo's text-based nature prefer the more user friendly web-based interface of MajorCool.
</abstract>

<toc>

<sect>Introduction
<p>
This HOWTO is divided into several sections.  The Sendmail portion of this HOWTO is a general discussion about Majordomo and how it interfaces with Sendmail, as well as the various ways Majordomo can be set up and the consequences of such decisions.  In contrast, the rest of the HOWTO is set up like a tutorial guiding a user through a plain installation process of Majordomo.  I recommend going over the generic installation process described in the sections after Sendmail, referencing the appropriate portions of the Sendmail section when necessary (the appropriate sections are mentioned in the appropriate places).  Then, read the Sendmail section carefully and decide exactly how to configure your system.  Finally, a List of Terms provides definitions for some of the more abstruse terms.
<p>
Also, when downloading any of the software mentioned in this document, if any of the official sites are down, the tarballs can be downloaded from my site--<tt>http://philosophy.lander.edu/~jarchie/majordomo/</tt>.
<sect1>Credits
<p>
Thanks go out (in alphabetical order) to a few people for their invaluable help.
<itemize>
<item>Lee Archie for proofreading
<item>James Bruce and Bill Poston for the opportunity to set up my first permanent machine running Majordomo
<item>Joseph D. Sloan for reading the Sendmail portion and making helpful suggestions
</itemize>
<sect1>References
<p>
Although I have tried to make this HOWTO as complete as possible, it is always a good idea to look at more than one source.  Below is a list of the resources that I found helpful when trying to configure Majordomo for the first time.
<p>
Books:
<enum>
<item>Bryan Costales with Eric Allman, <em/sendmail/.  Cambridge: O'Reilly, 1997.
<item>Alan Schwartz, <em/Managing Mailing Lists/.  Cambridge: O'Reilly, 1998.
</enum>
Free resources:
<enum>
<item>the documentation that comes with Sendmail especially <tt/README.cf/
<item>the documentation that comes with Majordomo especially <tt/INSTALL/ and <tt/NEWLIST/
<item>the <tt/Majordomo-Users/ Mailing List Archive (<tt>http://www.hpc.uh.edu/majordomo-users/</>)
<item>the documentation that comes with MajorCool
</enum>
<sect>Sendmail
<p>
Since Majordomo is responsible for managing E-mail lists, Majordomo relies heavily on a MTA such as Sendmail.  There are other MTA's such as Smail and Qmail out there; however, Sendmail is the oldest and most common.  This section introduces the reader to the areas of Sendmail that are useful or necessary to configure when using Majordomo.
<sect1>Aliases<label id="sec-aliases">
<p>
The Sendmail aliases file (usually <tt>/etc/aliases</>) is used for making aliases for E-mail addresses.  For example, once Majordomo is installed, usually an entry in the aliases file reads:
<tscreen><verb>
majordomo-owner:	jarchie
</verb></tscreen>
This entry means that all mail addressed to <tt/majordomo-owner@host.com/ will actually be sent to <tt/jarchie@host.com/.  Notice it is unnecessary to append the <tt/@host.com/ to <tt/jarchie/ because both users are on the same host.  If it were desired to redirect the message to a different user on a different host, one would have to add the <tt/@host.com/ portion.  
<p>
Another type of entry in the aliases file allows an E-mail to be redirected to multiple addresses people listed in a file:
<tscreen><verb>
testlist:		:include:/usr/local/majordomo-1.94.4/lists/testlist
</verb></tscreen>
This entry states that any message sent to <tt/testlist@host.com/ will be redirected to all the addresses listed in the file <tt>/usr/local/majordomo-1.94.4/lists/testlist</>.  The <tt/testlist/ file might look something like this:
<tscreen><verb>
johnarchie@emeraldis.com
srobirds@yahoo.com
acreswell@geocities.com
</verb></tscreen>
Majordomo is able to add or subtract addresses from a list by taking advantage of this feature.  When a <tt/subscribe/ request is processed, the user's E-mail address is appended to the <tt/testlist/ file; when an <tt/unsubscribe/ request is processed, the user's E-mail address is removed from the <tt/testlist/ file.  One can also add or subtract addresses manually simply by editing the file with a text editor such as <bf/vi/.
<p>
Since Majordomo needs to be able to process commands sent to it via E-mail, Sendmail must be able to execute the Majordomo program and pass the message to it.  This is done by adding another type of entry to the <tt/aliases/ file:
<tscreen><verb>
majordomo:		"|/usr/local/majordomo-1.94.4/wrapper majordomo"
</verb></tscreen>
The program <tt>/usr/local/majordomo-1.94.4/wrapper</> is a wrapper (SUID majordomo and SGID majordomo or daemon depending on the configuration) that runs the Majordomo program.  The quotation marks around the second part of the alias entry are used to tell Sendmail that this part of the entry is all one statement; the quotation marks would be unnecessary if there wasn't a space between <tt/wrapper/ and <tt/majordomo/.  The <tt>|</> is known as a "pipe"; it is used to tell Sendmail to send the E-mail to the wrapper via the standard input.  (Since all the wrapper does here is to call <tt/majordomo/, the E-mail is actually being sent to Majordomo.)  The wrapper accepts one parameter--the parameter of the program it is supposed to execute.  (Any parameters after the first will be passed to the program the wrapper is executing.)  For security reasons, the wrapper only executes programs located in the Majordomo directory, <tt>/usr/local/majordomo-1.94.4/</>.  This restriction prevents a programmer from using the wrapper to run programs that should not have Majordomo privileges.  (For example, <bf>wrapper /bin/vi</> would allow any user to edit any Majordomo configuration file.)  When a message is sent to <tt/majordomo@host.com/, Sendmail starts up the wrapper which, in turn, starts up <tt/majordomo/, and Sendmail sends the message to the <tt/majordomo/ script via the standard input.  Majordomo then extracts the commands out of the message and responds appropriately.
<sect1>Editing <tt/sendmail.cf/
<p>
Due to its arcane syntax, <tt/sendmail.cf/ is perhaps the most feared of all configuration files.  In the installation of <tt/majordomo/, it is not absolutely necessary to edit <tt/sendmail.cf/; however, a couple of features are extremely useful.  Unless major changes have to be made to <tt/sendmail.cf/ (which, thankfully, Majordomo does not require), editing the file is not that difficult.  All that need be done is adding extra lines to the file.
<sect2>Another Aliases File
<p>
Creating a separate file for the Majordomo aliases, such as <tt>/usr/local/majordomo-1.94.4/majordomo.aliases</>, is often a good idea.  This can be done rather easily by adding a line to the end of the <tt/sendmail.cf/ file
<tscreen><verb>
OA/usr/local/majordomo-1.94.4/majordomo.aliases
</verb></tscreen>
To have a <tt>/usr/local/majordomo-1.94.4/majordomo.aliases</>, Sendmail must be able to generate a database (<tt>/usr/local/majordomo-1.94.4/majordomo.aliases.db</>).  The easiest way to accomplish this is to go ahead and create an empty database for Sendmail to overwrite.
<tscreen><code>
[root@kes majordomo-1.94.4]# touch majordomo.aliases.db
[root@kes majordomo-1.94.4]# chmod 644 majordomo.aliases.db
</code></tscreen>
Another method to get around this issue is simply to create the <tt/majordomo.aliases/ file in the <tt>/etc/</> directory, rather than the Majordomo home directory.
<sect2>Undesirable Sendmail Security Features
<p>
For certain setups, some security measures that Sendmail uses can prevent Majordomo from working properly.  Obviously, these security features must be turned off.
<sect2>Sendmail Trusted Users<label id="sec-sendtrust">
<p>
Sendmail is programmed to make it difficult for people to make "perfect" forgeries of E-mail.  For example, when a user sends a message via SMTP, the source IP address is typically logged, and when a user sends a message by giving it directly to Sendmail and specifying the sender using <bf/sendmail -f/, Sendmail puts a warning message in the header specifying the user who really sent the message.  However, some programs need to be able to send messages masquerading as other users, and having this extra security line appended to the header is annoying.  Sendmail handles this problem by having trusted users.  Majordomo must run as a Sendmail trusted user since the program needs to send mail as other users.  This feature can be set up in two ways.  The easiest way is to just add Majordomo to the <tt/daemon/ group.  To add the <tt/majordomo/ user to the daemon group, edit the line in the <tt>/etc/group</> file from something that appears similar to
<tscreen><verb>
daemon::2:root,bin,daemon
</verb></tscreen>
to
<tscreen><verb>
daemon::2:root,bin,daemon,majordomo
</verb></tscreen>
Another way is to make Majordomo a trusted user by adding the line
<tscreen><verb>
Tmajordomo
</verb></tscreen>
to the <tt/sendmail.cf/ file.

<sect2>Sendmail Restricted Shell
<p>
If Sendmail is using <tt/smrsh/, then the only programs that can be executed are those under the <tt>/etc/smrsh/</> directory.  Perhaps the best solution to run the wrapper from the <tt/aliases/ file is to create a symbolic link from <tt>/etc/smrsh/wrapper</> to <tt>/usr/local/majordomo-1.94.4/wrapper</>.
<tscreen><code>
[root@kes smrsh]# ln -s /usr/local/majordomo-1.94.4/wrapper wrapper
</code></tscreen>
A second solution is actually moving the wrapper into the <tt>/etc/smrsh/</> directory.
<tscreen><code>
[root@kes smrsh]# mv /usr/local/majordomo/wrapper ./
</code></tscreen>
If security is not a major concern, the secure shell can be disabled.  One fairly crude method is simply to delete <tt>/usr/sbin/smrsh</>, and copy or link <tt>/bin/sh</> in its place.
<tscreen><code>
[root@kes sbin]# rm -f smrsh
[root@kes sbin]# ln -s /bin/sh smrsh
</code></tscreen>
A better (but more difficult) method is to edit <tt/sendmail.cf/.  Change the reference from <tt>/usr/sbin/smrsh</>
<tscreen><verb>
Mprog,		P=/usr/sbin/smrsh, F=lsDFMoqeu9, S=10/30, R=20/40, D=$z:/,
		T=X-Unix,
		A=sh -c $u
</verb></tscreen>
to <tt>/bin/sh</>
<tscreen><verb>
Mprog,		P=/bin/sh, F=lsDFMoqeu9, S=10/30, R=20/40, D=$z:/,
		T=X-Unix,
		A=sh -c $u
</verb></tscreen>
<sect2>Group Write Permission
<p>
If you plan on having a non-root user add and manage mailing lists, you will need to make the <tt/majordomo.aliases/ file that is group writable.  However, Sendmail will not allow this configuration for security reasons (see the section on <ref id="sendmail-security" name="Sendmail Security Issues">).  To disable this security feature, add the line
<tscreen><verb>
O DontBlameSendmail=GroupWritableAliasFile
</verb></tscreen>
to the <tt/sendmail.cf/ file.
Also, the lists directory must be group writable in order to add a list, but Sendmail will not allow this setup for similar reasons.  To disable this security feature, adding the line
<tscreen><verb>
O DontBlameSendmail=IncludeFileInGroupWritableDirPath
</verb></tscreen>
to the <tt/sendmail.cf/ configuration file is necessary.
<p>
<sect1>Configuring <tt/sendmail.cf/ Using the M4 Configuration
<p>
For administrators who do not want to edit the <tt/sendmail.cf/ file directly, it is possible to use M4 to create the file; this section describes how to make the changes discussed in the previous section to the <tt/mc/ file instead of the <tt/cf/ file.
<p>
The purpose of the M4 configuration is to provide an easy way to create the <tt/sendmail.cf/ file.  The idea is that the created <tt/mc/ file is easier to understand than the <tt/sendmail.cf/ file.  By running the m4 preprocessor, a <tt/sendmail.cf/ file is generated:
<tscreen><code>
[root@kes etc]# m4 /etc/sendmail.mc > /etc/sendmail.cf
</code></tscreen>
<sect2>Creating Another Aliases File
<p>
Add the line
<tscreen><verb>
define(`ALIAS_FILE',`/etc/aliases,/usr/local/majordomo/majordomo.aliases')
</verb></tscreen>
to the <tt/sendmail.mc/ file.
<sect2>Making Majordomo a Trusted User
<p>
Add the line
<tscreen><verb>
define(`confTRUSTED_USERS',`majordomo')
</verb></tscreen>
to the <tt/sendmail.mc/ file.
<sect2>Disabling Sendmail Secure Shell
<p>
Delete the line that reads
<tscreen><verb>
FEATURE(smrsh)
</verb></tscreen>
in the <tt/sendmail.mc/ file.
<sect2>Disabling Security Features
<p>
To disable the group write permission security check on the aliases file, add the line
<tscreen><verb>
define(`confDONT_BLAME_SENDMAIL',`GroupWritableAliasFile')
</verb></tscreen>
to the <tt/sendmail.mc/ file.
<p>
To disable the path write permission security check for the include files, add the line
<tscreen><verb>
define(`confDONT_BLAME_SENDMAIL',`IncludeFileInGroupWritableDirPath')
</verb></tscreen>
To enable both of these options, use
<tscreen><verb>
define(`confDONT_BLAME_SENDMAIL',`GroupWritableAliasFile,IncludeFileInGroupWritableDirPath')
</verb></tscreen>
Adding the last statement is equivalent to writing
<tscreen><verb>
O DontBlameSendmail=GroupWritableAliasFile,IncludeFileInGroupWritableDirPath
</verb></tscreen>
in <tt/sendmail.cf/, and this entry is the same as writing the entries on separate lines:
<tscreen><verb>
O DontBlameSendmail=GroupWritableAliasFile
O DontBlameSendmail=IncludeFileInGroupWritableDirPath
</verb></tscreen>
<sect1>Sendmail Security Concerns <label id="sendmail-security">
<p>
Security is inversely proportional to convenience; the only secure machine is one that cannot be accessed by anyone.  By disabling some of Sendmail's security features, a machine will inevitably become less secure.  However, it is important to understand the basic security risks in order to determine if the convenience is worth possible breaches of security.
<sect2>Consequences of Unsafe Group Writes
<p>
If a user has write permission to access an aliases file, <em/she should be a trusted user/.  By putting an entry into the aliases file (such as the one used to execute <bf/wrapper/) a user can execute any program with the privileges of Sendmail (<tt/daemon/ or, in older versions, <tt/root/).  The gaffe of this would allow people to remove or change the permissions of files that belong to <tt/daemon/ (using the <bf/rm/ or <bf/chmod/ commands in the aliases file).  To some extent, this possibility is avoided by using <bf/smrsh/; however, one must still be careful as to what files are in the <tt>/etc/smrsh/</> directory.
<p>
Another issue that arises is that the user who can access the aliases file can append or write to files that belong to <tt/daemon/ by using file redirection (a <tt/>>/ or <tt/>/ instead of a <tt/|/).  Even so, this breach too can be countered by adding a line to the <tt/sendmail.cf/ file that limits what files can be written to through the aliases file.  Add the line
<tscreen><verb>
O SaveFileEnvironment=/path/to/safe/files
</verb></tscreen>
to the <tt/sendmail.cf/ file or add
<tscreen><verb>
define(`confSAFE_FILE_ENV',`/path/to/safe/files')
</verb></tscreen>
to the <tt/sendmail.mc/ file.
However, this maneuver only leaves a thin layer of security between the user and daemon.  A much better idea would be to have the aliases file only writable by root and to create an SUID root program to automatically add and remove the Majordomo related aliases.
<p>
In the case of include or .forward files, commands or redirections are run as the user who owns  the file.  Therefore, if a file is group writable, a member of the group can execute commands as the user who owns the file.  In other words, any user in the <tt/majordomo/ group could execute commands as Majordomo.  However, since the <tt/majordomo/ user is created without a shell, commands or redirections will not be processed in include files owned by <tt/majordomo/.
<sect2>Consequences of Making Majordomo a Trusted User<label id="sec-construst">
<p>
If <tt/majordomo/ is a trusted user, then users added to the <tt/majordomo/ group will have the privileges of a trusted user.  If <tt/majordomo/ is a member of the <tt/daemon/ group, users in the <tt/majordomo/ group will not be trusted.  It may be a good idea to make <tt/majordomo/ a member of the <tt/daemon/ group, and create a separate group called <tt/majordomo/ for people managing the Majordomo lists in order to avoid making <tt/majordomo/ a trusted user.  Also, by making <tt/majordomo/ a member of the <tt/daemon/ group, the wrapper need not be executable by world.  (The wrapper can be executable by the group <tt/daemon/, and Sendmail can execute it through the <tt/aliases/ file since it executes binaries as <tt/daemon/.)  This added security prevents users on the system from "feeding" Majordomo false letters through the wrapper.
<sect2>Consequences of Unsafe Group Writable Directory Paths
<p>
If a user has group write permission to a directory, for example <tt>/etc/</>, the user could simply move any file and create a new one in its place.  An attack might go something like this
<tscreen><code>
[mallory@kes etc]$ mv aliases ...
[mallory@kes etc]$ vi aliases
</code></tscreen>
The user can then make her own aliases!  This attack, however, could be prevented by Sendmail's security checking for unsafe group writable paths.  Such an attack also would work with include and .forward files having unsafe paths.
<p>
In the case of Majordomo, the user in the <tt/majordomo/ group already has access to the include files, so this does not really compromise security.  However, an administrator should be careful to prevent these undesirable unsafe group writable directory paths from occurring in the future because Sendmail will <em/not/ check for them.
<sect2>Protecting Subscribers' Privacy
<p>
Unfortunately, sophisticated spammers can expand mail lists using the <bf/EXPN/ SMTP command.  For this reason, administrators should disable this feature when serving mailing lists.  Add the line
<tscreen><verb>
O PrivacyOptions=noexpn
</verb></tscreen>
to the <tt/sendmail.cf/ file or
<tscreen><verb>
define(`confPRIVACY_FLAGS',`noexpn')
</verb></tscreen>
to the <tt/sendmail.mc/ file.
<sect>Majordomo
<p>
Majordomo is, of course, the piece of code that this document revolves around; it consists of a collection of Perl scripts with the sole purpose of managing mailing lists.
<sect1>Preparing to Install
<p>
Download the gzipped source distribution of the latest version of Majordomo from <tt>http://www.greatcircle.com/majordomo/</> and uncompress it
<tscreen><code>
[jarchie@kes jarchie]$ zcat majordomo-1.94.4.tar.Z | tar xvf -
</code></tscreen>
This will create a subdirectory with all of the files necessary to install Majordomo; this directory <em/cannot/ be the same directory in which Majordomo is to be installed.
<p>
Majordomo must run under a specific UID and GID so when any of the scripts are run, they will run under Majordomo's UID.  Thus, it is necessary to decide what UID and GID Majordomo should run under.  Also, Majordomo must be a Sendmail trusted user.  (See <ref id="sec-construst" name="Consequences of Making Majordomo a Trusted User">)
<p>
Check the <tt>/etc/passwd</> and <tt>/etc/group</> files to find a UID and GID that are not taken.  For this example, a UID of 16 and a GID of 16 was chosen.  You have to decide on the location where the Majordomo scripts will reside; in this HOWTO, the directory <tt>/usr/local/majordomo-1.94.4/</> was chosen.  If you are using a shadowed password file add entries similar to
<tscreen><verb>
majordomo:x:16:16:Majordomo List Manager:/usr/local/majordomo-1.9.4:
</verb></tscreen>
to your <tt>/etc/passwd</> and add an appropriate entry to <tt>/etc/shadow</>.
<tscreen><verb>
majordomo:*:10883:0:88888:7:::
</verb></tscreen>
Use the other entries in these files as a guide for exactly what should be added.  <em/These are only the values for my system./  If you are not using shadowed passwords, only an entry in the <tt>/etc/passwd</> file is necessary.
<p>
To create a Majordomo group, add the line
<tscreen><verb>
majordomo:x:16:jarchie,majordomo
</verb></tscreen>
to your <tt>/etc/group</> file.  This will give you access to the Majordomo files that are group writable.  Also, you might want to add <tt/majordomo/ to the daemon group to make it a trusted user (See <ref id="sec-sendtrust" name="Sendmail Trusted Users">); to do this, change the line that looks something like
<tscreen><verb>
daemon:x:2:root,bin,daemon
</verb></tscreen>
to
<tscreen><verb>
daemon:x:2:root,bin,daemon,majordomo
</verb></tscreen>
<sect1>Editing the Installation Files
<p>
The <tt/Makefile/ contains all the information needed to install Majordomo; it is usually necessary to edit lines in the <tt/Makefile/ that refer to system specific settings so Majordomo will be able to install cleanly on your system.  Most of the default settings are correct; however, the following settings, almost invariably, need to be changed on a per system basis.
<tscreen><code>
[jarchie@kes majordomo-1.94.4]$ vi Makefile
</code></tscreen>
The settings
<tscreen><verb>
PERL = /bin/perl
CC = cc
W_HOME = /usr/test/majordomo-$(VERSION)
MAN = $(W_HOME)/man
W_USER = 123
W_GROUP = 45
</verb></tscreen>
should be changed to something more appropriate for your system.  For example, in my setup, the values were changed to
<tscreen><verb>
PERL = /usr/bin/perl
CC = gcc
W_HOME = /usr/local/majordomo-1.94.4
MAN = /usr/man
W_USER = 16
W_GROUP = 16
</verb></tscreen>
Also the <tt/majordomo.cf/ file must be created.  An easy way to create this file is to copy the provided <tt/sample.cf/ file to <tt/majordomo.cf/ and edit it.
<tscreen><code>
[jarchie@kes majordomo-1.94.4]$ cp sample.cf majordomo.cf
[jarchie@kes majordomo-1.94.4]$ vi majordomo.cf
</code></tscreen>
Again, most of the settings are correct by default, but the following lines might need to be changed for your system from
<tscreen><verb>
$whereami = "example.com";
$whoami = "Majordomo\@$whereami";
$whoami_owner = "Majordomo-Owner\@$whereami";
     $homedir = "/usr/test/majordomo";
$digest_work_dir = "/usr/local/mail/digest";
$sendmail_command = "/usr/lib/sendmail";
</verb></tscreen>
to something more appropriate such as
<tscreen><verb>
$whereami = "kes.emeraldis.com";
$whoami = "majordomo\@$whereami";
$whoami_owner = "majordomo-owner\@$whereami";
     $homedir = "/usr/local/majordomo-1.94.4";
$digest_work_dir = "/usr/local/majordomo-1.94.4/digest";
$sendmail_command = "/usr/sbin/sendmail";
</verb></tscreen>
<tt/$whoami/ and <tt/$whoami_owner/ do not need to be changed for Majordomo to work; however, I changed them because I like to avoid typing capital letters.  <tt/$digest_work_dir/ is a temporary directory where digest files should be placed; this directory should be assigned to wherever you want digests to be stored.  If you do not plan to use digested lists, do not worry about this option.  <tt/$whereami/, <tt/$homedir/, and <tt/$sendmail_command/ should be changed to appropriate values for your system.  Unlike the <tt/Makefile/, these options can always be changed after Majordomo is installed by editing <tt/majordomo.cf/ in the directory where Majordomo was installed.  (The configuration file is simply copied during setup.)
<sect1>Installing Majordomo
<p>
The next step is to compile the Majordomo wrapper.  The wrapper is the only Majordomo component that needs to be compiled because everything else is a collection of perl scripts and, therefore, is not compiled.
<tscreen><verb>
[jarchie@kes majordomo-1.94.4]$ make wrapper
</verb></tscreen>
To install the Majordomo files, execute the commands
<tscreen><verb>
[jarchie@kes majordomo-1.94.4]# make install
[jarchie@kes majordomo-1.94.4]# make install-wrapper
</verb></tscreen>
The first command can be done as the Majordomo user, but the second command needs to be done as <tt/root/ so the installation script can SUID root the Majordomo wrapper.  (Since, <tt/majordomo/ was created without a login shell or password, if you want to execute the first command as <tt/majordomo/, you will need to <tt/su majordomo/ as root in order to become <tt/majordomo/.)
<sect1>Creating the Majordomo Aliases
<p>
Sendmail aliases must be created for Majordomo so commands sent to Majordomo can be processed by Majordomo and the majordomo owner in order that people can E-mail you through the standard <tt/owner-majordomo/ address.  Add the following entries to your aliases file.  (See <ref id="sec-aliases" name="Aliases">)
<tscreen><verb>
majordomo:       "|/usr/local/majordomo-1.94.4/wrapper majordomo"
owner-majordomo: jarchie
majordomo-owner: jarchie
</verb></tscreen>
<sect1>Testing the Configuration
<p>
As a regular user (<em/not/ as <tt/majordomo/ <em/or/ as <tt/root/), run
<tscreen><code>
[jarchie@kes jarchie]$ /usr/local/majordomo-1.94.4/wrapper config-test
</code></tscreen>
This program can detect most problems in the Majordomo installation.
<sect1>Creating Lists
<p>
To create a list, create a file with the name of the list in the Majordomo lists directory.  For example, to create a list called test, create a test file as Majordomo
<tscreen><code>
[root@kes /]# su majordomo
[majordomo@kes /]$ touch /usr/local/majordomo-1.94.4/lists/test
</code></tscreen>
and add the related aliases
<tscreen><verb>
test:	       :include:/usr/local/majordomo-1.94.4/lists/test
owner-test:    jarchie
test-request:  "|/usr/local/majordomo-1.94.4/wrapper request-answer test"
test-approval: jarchie
</verb></tscreen>
<sect1>Further Testing of the Configuration
<p>
Now test the operation of the list by issuing a <tt/lists/ command to <tt/majordomo/.
<tscreen><code>
[jarchie@kes jarchie]$ echo lists | mail majordomo
</code></tscreen>
It should only take a second for <tt/majordomo/ to reply with a message containing all the lists which are currently set up.  Next, try issuing a <tt/help/ command.
<tscreen><code>
[jarchie@kes jarchie]$ echo help | mail majordomo
</code></tscreen>
Majordomo should reply with a list of all commands that Majordomo accepts.  It might be a good idea to save the message for future reference.
<p>
To see if the aliases are working properly, try subscribing and unsubscribing yourself to the list.
<tscreen><code>
[jarchie@kes jarchie]$ echo subscribe test | mail majordomo
</code></tscreen>
You will receive an E-mail message containing instructions on how to confirm your subscription as well as a letter confirming that your command was successful.  After sending back your confirmation, Majordomo should send back two letters--one letter stating that your subscribe request was successful and another letter welcoming you to the test list.  The owner of the list will also be sent a message stating that you have subscribed to the list.
<p>
To unsubscribe from a list, send a <tt/unsubscribe/ command
<tscreen><code>
[jarchie@kes jarchie]$ echo unsubscribe test | mail majordomo
</code></tscreen>
You should be sent back a letter stating that your command was successful.
<sect1>Creating Better Aliases
<p>
For some lists, it may be desirable to have Majordomo process messages before they reach the list.  For example, Majordomo has an option automatically to filter messages based on content (such as taboo words), or Majordomo can catch people trying to send Majordomo commands to the list.  To use these options, it is necessary to use a better set of aliases such as
<tscreen><verb>
test:        "|/usr/local/majordomo-1.94.4/wrapper resend -l test test-list"
test-list:   :include:/usr/local/majordomo-1.94.4/lists/test
owner-test:  jarchie
test-owner:  jarchie
test-request:  "|/usr/local/majordomo-1.94.4/wrapper majordomo -l test"
</verb></tscreen>
The last entry allows someone simply to send a message to <tt/test-request@kes.emeraldis.com/ with the text <tt/subscribe/ rather than sending a letter to <tt/majordomo@kes.emeraldis.com/ with the text <tt/subscribe test/.
<sect>MajorCool
<p>
MajorCool is a web-based interface to Majordomo allowing users to add and delete themselves from lists and manage lists that they own.  The installation is fairly straightforward; all that need be done is to unzip the files, edit one line in the <tt/Configure/ script, and execute the script.
<sect1>Extracting MajorCool
<p>
The latest files can be downloaded from <tt>http://ncrinfo.ncr.com/pub/contrib/unix/MajorCool/majorcool.tar.gz</>.
<tscreen><code>
[jarchie@kes jarchie]$ mkdir majorcool
[jarchie@kes jarchie]$ mv majorcool.tar.gz ./majorcool/
[jarchie@kes majorcool]$ zcat majorcool.tar.gz | tar xvf -
</code></tscreen>
<sect1>Edit the <tt/Configure/ Script
<p>
Open <tt/Configure/ and
<tscreen><code>
[jarchie@kes majorcool]$ vi Configure
</code></tscreen>
change the line that reads
<tscreen><verb>
PERLBIN="/usr/local/bin/perl"	# How to start a perl script
</verb></tscreen>
to the proper location of perl
<tscreen><verb>
PERLBIN="/usr/bin/perl"		# How to start a perl script
</verb></tscreen>
otherwise, MajorCool will not be installed properly.
<sect1>Installing MajorCool
<p>
When running the <tt/Configure/ script, if the default choice for an option is okay, simply pressing Enter will accept the default.
<tscreen><code>
[root@kes majorcool]# ./Configure 
</code></tscreen>
The <tt/Configure/ script will ask you to hit Enter a few times, and then it will ask for the location of Majordomo and some more questions about the setup of your web server.
<tscreen><code>
What is the installation directory of Majordomo?
	[]: /usr/local/majordomo-1.94.4
Will place the MajorCool programs in /usr/local/majordomo-1.94.4.
 
What is the path to your Majordomo configuration file?
	[/usr/local/majordomo-1.94.4/majordomo.cf]: 
Using configuration file name '/usr/local/majordomo-1.94.4/majordomo.cf'
 
Where would you like temp files created when MajorCool runs?
	[/tmp]: 

MajorCool needs to install CGI programs, support files, and icons in
your Web server directories.
 
What is the root directory for your Web server?
	[]: /home/httpd
 
Where is the cgi-bin directory for your Web server?
	[/home/httpd/cgi-bin]: 
Will place the programs in /home/httpd/cgi-bin.
 
What is your server's URL for '/home/httpd/cgi-bin'?
	[/cgi-bin]: 
 
Where is the image directory for your Web server?
	[/home/httpd/icons]: 
Will place the icons in /home/httpd/icons.
 
What is your server's URL for '/home/httpd/icons'?
	[/images]: /icons
 
Where is the root directory for documents on your Web server?
	[]: /home/httpd/html
</code></tscreen>
The <tt/Configure/ script will ask other questions that are less critical.  (The defaults are fine, but you might want to change a few settings to fit your preferences.  Unlike some of the web-server questions, the meanings should be obvious from the context.)  When the configuration file that the script generated from your answers is displayed, you should accept the new version.
<tscreen><code>
Accept the new version? [yes|no|list|edit|diff]? y
</code></tscreen>
The installation script will install the MajorCool files and run the <tt/majordomo/ cgi script which outputs the html file to the console.  Check to see if the installation worked by viewing the <tt/majordomo/ cgi script from the web.
<tscreen><code>
[jarchie@kes jarchie]$ lynx http://localhost/cgi-bin/majordomo
</code></tscreen>
<sect>List of Terms
<p>
<descrip>
<tag/digest/ a collection of new messages mailed to the members of an archived list as one message.  A list is called digested when it is archived and, periodically, a digest is sent out.
<tag/GID/  (Group ID) an identification number assigned to files, directories, and processes to restrict access--similar to UID except multiple people can be a member of a group.  On Unix type systems, groups can be set up (defined in the <tt>/etc/group</> file).  When a user name is a member of a group, she can access files created with that GID (assuming permissions allow it).
<tag/MTA/ (Mail Transfer Agent) a program, such as Sendmail, responsible for passing mail from one location to another.
<tag/SGID/ (Set Group ID) a file attribute which allows a program to run with specific group privileges no matter who executes it.
<tag/smrsh/ (SendMail Restricted SHell) the shell that Sendmail uses to execute programs.  <bf/smrsh/ puts restrictions on the programs that can be run to make it safer than using a regular shell such as the Bourne Shell.
<tag/SUID/ (Set User ID) a file attribute which allows a program to run as a specific user no matter who executes it.
<tag/UID/ (User ID) an identification number assigned to files directories, and processes--similar to GID except every user has a unique UID.  Every process must run under a UID (the one-to-one relationship between the UID and user name is defined in <tt>/etc/passwd</>).  The process' UID determines what the program can access.  In general a regular user can change the permissions on files that she owns unless the UID is 0 (the <tt/root/ user).  In that case, <tt/root/ can modify any files on the system.
<tag/wrapper/ a program used to start another program; usually a wrapper is SUID or SGID so it can bestow privileges onto another program that the other program would not normally have.
</descrip>
</article>
