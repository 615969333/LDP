<CHAPTER ID="Tuning">
<TITLE>Tuning Mosix</TITLE>
<SECT1><TITLE>Optimising Mosix</TITLE>
<PARA>
Login a normal terminal as root. Type

 
<PROGRAMLISTING>
       setpe -r 
</PROGRAMLISTING>
 

     which, if everything went right, will give you a listing of your
     /etc/mosix.map. If things did not go right, try 

 
<PROGRAMLISTING>
        setpe -w -f /etc/mosix.map 
</PROGRAMLISTING>
 

     to set up your node. 
     
     Then, type 

  
<PROGRAMLISTING>
       cat /proc/$$/lock
</PROGRAMLISTING>
 

     to see if your child processes are locked in your mode (1) or can
     migrate (0). If for some reason you find your processes are locked, 
     you can change this with 

<PROGRAMLISTING>
        echo 0 > /proc/$$/lock
</PROGRAMLISTING>

     until you fix the problem. 

   Repeat the whole configuration scheme for a second computer. 

   The programs tune_kernel and prep_tune that Mosix uses to calibrate
     the individual nodes do not work with the SuSE distribution.
     However, you can fake it. First, bring the computer you want to
     tune and another computer with Mosix installed down to single user  
mode by typing

<PROGRAMLISTING>
        init 1
</PROGRAMLISTING>

     as root. All other computers on the network should be shutdown if
     possible. 

   On both machines, run the following commands:

<PROGRAMLISTING>
        /etc/init.d/network start
        /etc/init.d/mosix start
        echo 1 > /proc/mosix/admin/quiet
</PROGRAMLISTING>

     This fakes prep_tune and the first parts of tune_kernel. Note that
     if you have a laptop with a pcmcia network card, you will have to 
     run

<PROGRAMLISTING>
        /etc/init.d/pcmcia start
</PROGRAMLISTING>

     instead of "/etc/init.d/network start". 

   On the computer you want to tune, run tune_kernel and follow 
     instructions. Depending on your machines, this can take a while -
     if you have a dog, this might be the time to go on that long, long
     walk you've always promised him.

     tune_kernel will create a program called "pg" in /root for testing
     reasons. Ignore it. 

  After tuning is over, copy the contents of /tmp/overheads to the
     file /etc/overheads (and/or recompile the kernel). 

   Repeat the tuning procedure for each computer. Reboot, enjoy Mosix, 
and
     don't forget to brag to your friends about your new cluster.


</PARA>
</SECT1>

<SECT1><TITLE>Where to place your files</TITLE>
<PARA>

</PARA>
</SECT1>



</CHAPTER>


