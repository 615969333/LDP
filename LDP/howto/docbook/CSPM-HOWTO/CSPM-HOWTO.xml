<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
     "http://docbook.org/xml/4.1.2/docbookx.dtd" []>

<article id="cspm">
	<articleinfo><title>Compaq Storage Performance Monitor HOWTO</title>
		<abstract>
			<para>This HOWTO provides an overview of the Compaq Storage Performance Monitor, including a description of the product and installation and configuration information.</para>
		</abstract>
		<author>
			<firstname>Chris</firstname>
			<surname>Lorenz</surname>
			<affiliation>
				<address><email>lorenzc@us.ibm.com</email></address>
			</affiliation>
		</author>
		<pubdate>2002-07-11</pubdate>
		<revhistory>
			<revision>
				<revnumber>1.0</revnumber>
				<date>2002-07-11</date>
				<authorinitials>CL</authorinitials>
			</revision>
		</revhistory>
	</articleinfo>
<sect1 id="copy"><title>Copyright and Legal Notice</title>
		<para>Copyright &copy; 2002 IBM Corporation. All
		rights reserved.
		</para>
		<para>This document is provided "AS IS," with no
		express or implied warranties.  Use the information in
		this document at your own risk.
		</para>
		<para>Linux is a registered trademark of Linus Torvalds. Other company, product, and service 
		names may be trademarks or service marks of others.
		</para>
<para>Permission is granted to copy, distribute, and/or modify this document under the terms of the GNU Free Documentation License, Version 1.1 or any later version published by the Free Software Foundation with no Invariant Sections, no Front-Cover text, and no Back-Cover text.  A copy of the license can be found at <ulink url="http://www.gnu.org/licenses/fdl.txt">http://www.gnu.org/licenses/fdl.txt</ulink>.</para>
</sect1>
<sect1><title>What Is the Compaq Storage Performance Monitor?</title>
<para>The Compaq Storage Performance Monitor (CSPM), written by Don Dupuis of Compaq Computer Corporation, is a graphical tool that monitors read and write statistics on Linux&reg; systems.  CSPM monitors the system on a per disk, per controller, and systemwide basis.  CSPM gathers all the data automatically and then generates a histogram display of system throughput and of every disk and controller.  By default, CSPM monitors sectors and blocks.  It  can also monitor IOs, merges, and reads and writes.</para></sect1>
<sect1><title>Requirements</title>
<para>This section describes the requirements for different versions of CSPM.</para>
<sect2><title>Requirements for CSPM V1.0</title>
<para>CSPM V1.0 requires the following:</para>
<itemizedlist><listitem><para>Red Hat Linux 7.2 or later, or Mandrake 8.2 or later.</para></listitem>
<listitem><para>The Trolltech Qt 3.0 C++ application development environment, which is available for download from Trolltech for free.</para></listitem>
<listitem><para>If you wish to gather statistics on more than the default 16 disks, you will need to download the following patch, created by Mingming Cao of IBM:  <ulink url="http://lse.sourceforge.net/resource/diskio.html">http://lse.sourceforge.net/resource/diskio/diskio.html</ulink>. </para></listitem></itemizedlist></sect2>
<sect2><title>Requirements for CSPM V2.0 and Later</title>
<para>CSPM V2.0 and later require the following:</para>
<itemizedlist><listitem><para>Red Hat Linux 7.2 or later, or Mandrake 8.2 or later.</para></listitem>
<listitem><para>The Trolltech Qt 3.0 C++ application development environment, which is available for download from Trolltech for free.</para></listitem>
</itemizedlist>
<para>CSPM V2.0 and later gather statistics on all major devices in the system (these versions of CSPM use Stephen Tweedie's <command>sar</command> kernel patch, which allows more than 15 disks to be monitored).</para></sect2></sect1>
<sect1><title>Installing CSPM and its Requirements</title>
<para>This section describes how to acquire the Qt application development environment and install CSPM.</para>
<sect2><title>Installing Qt 3.0 or Later</title>
<para>Qt 3.0 or later must be installed on the system before you install CSPM.   Follow these steps to acquire and configure Qt:<itemizedlist><listitem><para>Download the Qt X/11 Free Edition from <ulink url="www.trolltech.com">http://www.trolltech.com</ulink> for the latest version of Qt. </para></listitem>
<listitem><para>Follow Trolltech's instructions for installing Qt. </para></listitem>
<listitem><para>When running ./configure, add the <constant>-thread</constant> switch to the configure program so that Qt is installed to run in multithreaded mode. </para></listitem>
<listitem><para>Be sure to export the variables QTDIR and LD_LIBRARY_PATH, as described in the Qt installation instructions that are downloaded with the software.</para></listitem></itemizedlist></para></sect2>
<sect2><title>Installing CSPM</title>
<para>The following steps describe how to download and install CSPM and must be run by the root user.  The installation process creates a directory called <filename>cspm</filename> and places all the files in that directory.<orderedlist><listitem><para>Download CSPM from SourceForge at <ulink url="http://sourceforge.net/projects.cspm">http://sourceforge.net/projects.cspm</ulink>.</para></listitem>
<listitem><para>Untar the <filename>spm.tar.gz</filename> file:</para>
<para><programlisting># tar xvzf spm.tar.gz</programlisting></para></listitem>
<listitem><para>Compile CSPM:</para>
<para><programlisting># make all</programlisting></para>
<para>The make command creates the binary call <command>spm </command>in the current directory.</para></listitem>
<listitem><para>Start the CSPM monitor:</para>
<para><programlisting># ./spm</programlisting></para></listitem></orderedlist></para>
<para>If a segmentation fault occurs when <command>spm</command> is starting up, make sure that you have set the QTDIR and LD_LIBRARY_PATH variables, as described in the Qt installation instructions that are downloaded with the software.</para></sect2></sect1>
<sect1><title>Modifying CSPM Defaults</title>
<para>You can modify the default grid and monitoring settings by selecting <menuchoice><guimenu>Options</guimenu>
<guimenuitem>Preferences</guimenuitem></menuchoice>. When you select the Options pulldown, you can view the Grid tab or the Monitor tab.</para>
<para>From the Grid tab you can change:
<itemizedlist><listitem><para>the color of the grid lines</para></listitem>
<listitem><para>the distance (or time), in seconds, between intervals when data is collected (horizontal lines appear at each interval)</para></listitem>
<listitem><para>the color of the read and write lines</para></listitem>
<listitem><para>the number of horizontal range bars (default is 5)</para></listitem>
<listitem><para>the size of the histogram titles</para></listitem></itemizedlist></para>
<para>
<inlinegraphic fileref="snapshot7.png"/></para>
<para>From the Monitor tab you can change:<itemizedlist><listitem><para>the height and width of the display boxes (in pixels)</para></listitem>
<listitem><para>the colors of the display boxes</para></listitem>
<listitem><para>the type of data to be monitored (IOs, data, reads and writes, sectors and blocks)</para></listitem></itemizedlist></para>
<para>
<inlinegraphic fileref="snapshot8.png"/></para>
</sect1>
<sect1><title>Interpreting CSPM Output</title>
<para>When you start up CSPM, a collection of histograms appears.  Each histogram shows data for either a controller, disk, partition, or system throughput.  The key at the bottom of the histogram tables tells which color of histogram box corresponds to which type of device.  The following sample CSPM session shows controller (purple), disk (green), partition (orange), and system data.
</para>
<para>
<inlinegraphic fileref="snapshot5.png"/>
</para>
<para>Use the horizontal and vertical scroll bars to view controller, disk, and partition histograms that do not fit on the initial screen.</para>
<para>By default, the number of &quot;range bars&quot; along the y-coordinate of each histogram is five.  When there is no activity for a particular device, CSPM provides default values of 0, 0.2, 0.4, 0.6, and 0.8. Once activity begins on the device, CSPM sets the five values in equal increments from 0 to the peak data value collected in each collection interval.  Sometimes the grid lines fall directly on the range bar numbers, making the numbers hard to read.  You can either adjust the color of the grid lines, adjust the collection interval, or try to ignore the grid lines. </para>
<para>To see information about a partition (such as filesystem name, space used, and space available), right-click on the partition's histogram and then left-click on <guimenuitem>Properties</guimenuitem>.  A Partition Status window opens that displays information about the selected partition. </para>
<para>
<inlinegraphic fileref="snapshot9.png"/>
</para>
<para>(This feature will be implemented for controllers and disks in a later release of CSPM.)</para></sect1>
</article>









